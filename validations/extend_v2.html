<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Validation report: extend_v2 &#8212; Chempleter 0.1.0b8 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=9550617d" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <script src="../_static/documentation_options.js?v=630e2062"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <link rel="icon" href="../_static/chempleter.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Validation report: bridge_v1" href="bridge_v1.html" />
    <link rel="prev" title="Validation report: extend_v1" href="extend_v1.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="validation-report-extend-v2">
<h1>Validation report: extend_v2<a class="headerlink" href="#validation-report-extend-v2" title="Link to this heading">¶</a></h1>
<p>Model: extend_v2</p>
<p>Samples Generated: 500</p>
<p>Generated On: 2026-01-04 20:40</p>
<section id="generation-quality-metrics">
<h2>Generation Quality Metrics<a class="headerlink" href="#generation-quality-metrics" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Uniqueness</p></th>
<th class="head"><p>Novelty</p></th>
<th class="head"><p>SELFIES fidelity</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1.0000</p></td>
<td><p>0.9920</p></td>
<td><p>0.0077</p></td>
</tr>
</tbody>
</table>
</section>
<section id="descriptor-statistics">
<h2>Descriptor Statistics<a class="headerlink" href="#descriptor-statistics" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Descriptor</p></th>
<th class="head"><p>Average</p></th>
<th class="head"><p>Minimum</p></th>
<th class="head"><p>Maximum</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>MW</p></td>
<td><p>238.5955</p></td>
<td><p>83.0900</p></td>
<td><p>448.3600</p></td>
</tr>
<tr class="row-odd"><td><p>LogP</p></td>
<td><p>1.9655</p></td>
<td><p>-1.9000</p></td>
<td><p>6.3100</p></td>
</tr>
<tr class="row-even"><td><p>SA_Score</p></td>
<td><p>3.4320</p></td>
<td><p>1.1600</p></td>
<td><p>6.8300</p></td>
</tr>
<tr class="row-odd"><td><p>QED</p></td>
<td><p>0.6327</p></td>
<td><p>0.2250</p></td>
<td><p>0.9430</p></td>
</tr>
<tr class="row-even"><td><p>Fsp3</p></td>
<td><p>0.5788</p></td>
<td><p>0.0000</p></td>
<td><p>1.0000</p></td>
</tr>
<tr class="row-odd"><td><p>RotatableBonds</p></td>
<td><p>2.9760</p></td>
<td><p>0.0000</p></td>
<td><p>11.0000</p></td>
</tr>
<tr class="row-even"><td><p>RingCount</p></td>
<td><p>2.4040</p></td>
<td><p>0.0000</p></td>
<td><p>6.0000</p></td>
</tr>
<tr class="row-odd"><td><p>TPSA</p></td>
<td><p>44.7686</p></td>
<td><p>0.0000</p></td>
<td><p>127.8700</p></td>
</tr>
<tr class="row-even"><td><p>RadicalElectrons</p></td>
<td><p>0.0060</p></td>
<td><p>0.0000</p></td>
<td><p>1.0000</p></td>
</tr>
</tbody>
</table>
</section>
<section id="descriptor-distributions">
<h2>Descriptor Distributions<a class="headerlink" href="#descriptor-distributions" title="Link to this heading">¶</a></h2>
<img alt="Descriptor Distributions" class="align-center" src="../_images/extend_v2.png" />
</section>
<section id="development-notes">
<h2>Development Notes<a class="headerlink" href="#development-notes" title="Link to this heading">¶</a></h2>
<p>The model was trained using SELFIES representations generated from randomized SMILES strings.
The training corpus was derived from the QM9 and ZINC datasets.
Randomization was applied at every data access by converting each SMILES string into a non-canonical, randomly ordered form before encoding it into SELFIES.</p>
<p>Training was stopped once the loss reached a clear plateau, even after lowering the learning rate to 1e-5.
Compared to training on canonical (non-randomized) SMILES, convergence was slower. This behavior is expected, as the same molecule can appear in different randomized forms across batches, increasing input variability and reducing batch-to-batch consistency.</p>
<p>A key challenge introduced by SMILES randomization is vocabulary stability. Because SELFIES are generated on the fly for each batch, new symbols may appear that were not present when the stoi mapping was originally constructed.
This can result in index errors during tokenization if the mapping is incomplete. Multiple runs through the dataset to get a more complete stoi mapping may be needed or update the stoi on the fly during the pipeline.</p>
<p>PyTorch dataset was defined as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ChempleterRandomisedSmilesDataset</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
<span class="w">   </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   PyTorch Dataset for SELFIES molecular representations.</span>

<span class="sd">   :param smiles_file: Path to CSV file containing SMILES strings in a &quot;smiles&quot; column.</span>
<span class="sd">   :type smiles_file: str</span>
<span class="sd">   :param stoi_file: Path to JSON file mapping SELFIES symbols to integer tokens.</span>
<span class="sd">   :type stoi_file: str</span>
<span class="sd">   :returns: Integer tensor representation of tokenized molecule with dtype=torch.long.</span>
<span class="sd">   :rtype: torch.Tensor</span>
<span class="sd">   &quot;&quot;&quot;</span>

   <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">smiles_file</span><span class="p">,</span> <span class="n">stoi_file</span><span class="p">):</span>
      <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
      <span class="n">smiles_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">smiles_file</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">smiles_dataframe</span><span class="p">[</span><span class="s2">&quot;smiles&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
      <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">stoi_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selfies_to_integer</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

   <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

   <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
      <span class="n">molecule_in_smiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

      <span class="c1"># try randomisation</span>
      <span class="n">molecule</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">molecule_in_smiles</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">molecule</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
               <span class="n">molecule_in_selfies</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span>
                  <span class="n">Chem</span><span class="o">.</span><span class="n">MolToSmiles</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">canonical</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">doRandom</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
               <span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
               <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELFIES encoding error for randomised SMILES: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
            <span class="n">molecule_in_selfies</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span><span class="n">molecule_in_smiles</span><span class="p">)</span>

      <span class="n">symbols_molecule</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;[START]&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">split_selfies</span><span class="p">(</span><span class="n">molecule_in_selfies</span><span class="p">))</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;[END]&quot;</span><span class="p">]</span>
      <span class="p">)</span>
      <span class="n">integer_molecule</span> <span class="o">=</span> <span class="p">[]</span>

      <span class="c1"># check if all symbols exist in stoi</span>
      <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">symbols_molecule</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">symbol</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">selfies_to_integer</span><span class="p">:</span>
               <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                  <span class="sa">f</span><span class="s2">&quot;Molecule symbol not found in stoi. Add </span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2"> in stoi with correct integer mapping.&quot;</span>
               <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
               <span class="n">integer_molecule</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selfies_to_integer</span><span class="p">[</span><span class="n">symbol</span><span class="p">])</span>

      <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">integer_molecule</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">long</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/chempleter_logo.png" alt="Logo" />
    
  </a>
</p>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../demo.html">Chempleter modes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../validation.html">Model history</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="https://github.com/davistdaniel/chempleter">Github</a></li>
    
    <li class="toctree-l1"><a href="https://pypi.org/project/chempleter/">PyPi</a></li>
    
</ul>

<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2026, Davis Thomas Daniel.
      
      |
      <a href="../_sources/validations/extend_v2.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>